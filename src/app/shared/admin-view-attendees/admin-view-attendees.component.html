<div class="bg-[#F9FAFB] md:flex-row h-screen overflow-hidden">
    <div class="flex-1 mt-4 mr-2 p-2">
        <div class="flex dash border-[1px] rounded-t-lg pl-5">
            <div class="flex items-center justify-center">
                <img src="assets/esp/logo.png" alt="Event Vista Logo" class="mr-2" />
                <h2 class="font-bold text-[24px]">
                    Event <span class="text-red-700"> Vista </span>
                </h2>
            </div>
            <div class="dash-content-right mb-2 flex ml-auto space-x-4 mt-2 xl:mt-2 h-10">
                <img src="assets/esp/dashboard/bell.png" alt="Bell Icon" class="block" />
                <div class="relative">
                    <img *ngIf="profileImageUrl; else svgFallbackp" [src]="profileImageUrl" alt="Avatar" class="block cursor-pointer border rounded-full w-10 h-10" (click)="toggleCard()" />
                    <ng-template #svgFallbackp>
                      <svg width="18" height="18" viewBox="0 0 18 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="bg-[#C7B9DA] pt-2 pb-1 w-10 h-10 rounded-full border">
                        <path d="M17 19V17C17 15.9391 16.5786 14.9217 15.8284 14.1716C15.0783 13.4214 14.0609 13 13 13H5C3.93913 13 2.92172 13.4214 2.17157 14.1716C1.42143 14.9217 1 15.9391 1 17V19M13 5C13 7.20914 11.2091 9 9 9C6.79086 9 5 7.20914 5 5C5 2.79086 6.79086 1 9 1C11.2091 1 13 2.79086 13 5Z" stroke="#344054" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                      </svg>
                    </ng-template>
                    <div *ngIf="showProfileCard" class="absolute right-0 mt-[1rem] w-72 bg-white shadow-md rounded-lg p-6 z-10">
                        <div class="flex items-center mb-4">
                            <img *ngIf="profileImageUrl; else svgFallbackp" [src]="profileImageUrl" alt="Navbar Image" class="mr-2 border rounded-full w-10 h-10" />
                            <div class="ml-2">
                                <h3 class="text-lg medium">{{ fullName }}</h3>
                                <p class="text-xs text-gray-500">{{ email }}</p>
                            </div>
                        </div>
                        <hr class="bg-gray-500 border-2 dark:bg-gray-800 dark:border-gray-700 mb-4" />
                        <button class="flex items-center text-sm text-gray-500" (click)="accountSettings()">
                            <img src="assets/esp/dashboard/settings.png" class="w-4 h-4 mr-2" />
                            Account settings
                        </button>
                    </div>
                </div>
                <p class="block pt-2 h-8">{{ fullName }}</p>
                <button class="h-8 pt-3" (click)="toggleCard()">
                    <img src="assets/esp/dashboard/down.png" alt="Down Icon" class="block mr-8" [class.clicked]="showProfileCard" />
                </button>
            </div>
        </div>

        <div class="bg-[#EAECF0] pl-6 p-2">
            <div class="flex items-center space-x-2">
                <img src="assets/esp/dashboard/event-create-back.png" alt="">
                <h3 role="button" routerLink="/admin-event" class="text-[14px] font-semibold text-[#BC1B06]">Back to Events</h3>
            </div>
            <div class="text-lg font-bold mb-2">{{ eventdetails.eventTitle }}</div>
            <div *ngIf="eventdetails" class="flex space-x-4">
                <p class="flex text-sm text-gray-600" *ngIf="eventdetails.eventType != 'VIRTUAL'"><img src="assets/esp/dashboard/location.png" alt="location" class="mr-2 size-4">{{ eventdetails.venueLocation }}</p>
                <p class="flex text-sm text-gray-600"><img src="assets/esp/dashboard/date.png" alt="location" class="mr-2 size-4">{{ eventdetails.eventStartDate }}</p>
                <p class="flex text-sm text-gray-600"><img src="assets/esp/dashboard/ticket.png" alt="location" class="mr-2 size-4">{{ eventdetails.ticketStatus }}</p>
              </div>
        </div>
        
        <div class="overflow-y-hidden m-4 border border-gray-200 rounded-lg">
            <div class="searchFilter flex flex-wrap items-center space-x-40 md:space-x-4 p-4">
                <div class="relative flex-grow mb-4 md:mb-0 font-bold">
                    Attendees
                    <span class="p-4 bg-[#FFF4ED] rounded-full size-4 absolute ml-3">
                        <span class="absolute -mt-3 -ml-2 font-bold text-[#BC1B06]">{{ totalUsersCount }}</span>
                    </span>
                </div>
                <div class="relative mb-4 md:mb-0 w-80">
                    <img src="assets/esp/dashboard/search.png" alt="Location Icon" class="absolute top-1/2 transform -translate-y-1/2 left-3 w-4" />
                    <input
                        type="text"
                        id="filterSearch"
                        #filterSearchInput
                        [(ngModel)]="filterUserEmail"
                        (ngModelChange)="searchUser(filterUserEmail, eventId)"
                        class="shadow-sm bg-white border border-gray-300 text-gray-900 text-sm rounded-md block pl-10 p-2.5 w-full"
                        placeholder="Search users by name or email"
                    />
                </div>
                <div class="relative mb-4 md:mb-0">
                    <img src="assets/esp/dashboard/filter.png" alt="Filter Icon" class="absolute top-1/2 transform -translate-y-1/2 left-3 w-4" />
                    <select
                        id="filter"
                        #filterGenderSelect
                        [(ngModel)]="filterByGender"
                        (ngModelChange)="getAttendeeByGender(filterByGender, eventId)"
                        class="shadow-sm bg-white border border-gray-300 text-gray-900  font-bold text-sm rounded-md block pl-10 p-2.5 w-full custom-select"
                    >
                        <option class="text-gray-400" value="" disabled selected>Filter</option>
                        <option value="male">Male</option>
                        <option value="female">Female</option>
                    </select>
                </div>
            </div>
            <div class="overflow-x-auto">
                <div *ngIf="!filteredAttendee || filteredAttendee.length === 0" class="flex justify-center items-center">
                    <img src="assets/esp/dashboard/users-temp.png" class="mb-10 mt-10" alt="Users Temp">
                </div>
                <div *ngIf="filteredAttendee && filteredAttendee.length > 0" class="overflow-x-auto">
                    <table class="min-w-full bg-white border-collapse table-fixed">
                        <thead>
                            <tr class="bg-gray-100 text-sm">
                                <th class="py-2 px-4 border-b-2 w-1/6 text-left">Name</th>
                                <th class="py-2 px-4 border-b-2 w-1/6 text-left">Email address</th>
                                <th class="py-2 px-4 border-b-2 w-1/6 text-left">Phone</th>
                                <th class="py-2 px-4 border-b-2 w-1/6 text-left">Age</th>
                                <th class="py-2 px-4 border-b-2 w-1/6 text-left">Gender</th>
                                <th class="py-2 px-4 border-b-2 w-1/6 text-left">Ticket type</th>
                                <th class="py-2 px-4 border-b-2 w-1/6 text-left">Quantity</th>
                                <th class="py-2 px-4 border-b-2 w-1/6 text-left whitespace-nowrap">Registration date</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let attendee of filteredAttendee" class="border-b text-sm">
                                <td class="py-2 px-4 flex items-center">
                                    <ng-container *ngIf="attendee.profileImageUrl; else svgFallback">
                                        <img [src]="attendee.profileImageUrl" alt="User Profile" class="w-8 h-8 rounded-full mr-2">
                                    </ng-container>
                                    <ng-template #svgFallback>
                                        <svg width="18" height="20" viewBox="0 0 18 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="bg-[#C7B9DA] mr-2 pt-2 pb-1 w-8 h-8 rounded-full border">
                                            <path d="M17 19V17C17 15.9391 16.5786 14.9217 15.8284 14.1716C15.0783 13.4214 14.0609 13 13 13H5C3.93913 13 2.92172 13.4214 2.17157 14.1716C1.42143 14.9217 1 15.9391 1 17V19M13 5C13 7.20914 11.2091 9 9 9C6.79086 9 5 7.20914 5 5C5 2.79086 6.79086 1 9 1C11.2091 1 13 2.79086 13 5Z" stroke="#344054" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                                        </svg>
                                    </ng-template>
                                    <span class="font-medium">{{ attendee.name }}</span>
                                </td>
                                <td class="py-2 px-4">{{ attendee.email }}</td>
                                <td class="py-2 px-4">{{ attendee.phoneNumber }}</td>
                                <td class="py-2 px-4">{{ attendee.age }}</td>
                                <td class="py-2 px-4">{{ attendee.gender }}</td>
                                <td class="py-2 px-4">{{ attendee.ticketType }}</td>
                                <td class="py-2 px-4">{{ attendee.ticketQuantity }}</td>
                                <td class="py-2 px-4">{{ attendee.registrationDate | customDate: 'MMM-DD-YYYY' }}</td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="pagination-controls flex justify-between items-center m-4">
                        <button (click)="prevPage()" [disabled]="currentPage === 1" class="text-gray-700 py-2 px-4 flex items-center border rounded-md">
                        <svg width="20" height="20" class="mr-4" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M15.8334 10.0013H4.16675M4.16675 10.0013L10.0001 15.8346M4.16675 10.0013L10.0001 4.16797" stroke="#344054" stroke-width="1.67" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        Previous
                        </button>
    
                        <div>
                        <span *ngFor="let page of getPageNumbers()">
                            <button (click)="goToPage(itemsPerPage)" [class.active]="currentPage === page" class="text-gray-700 px-4 py-2 rounded-md mx-1">
                            {{page}}
                            </button>
                        </span>
                        </div>
    
                        <button (click)="nextPage()" [disabled]="(currentPage * itemsPerPage) >= totalUsersCount" class="text-gray-700 py-2 px-4 flex items-center border rounded-md">
                        Next
                        <svg width="14" height="14" class="ml-4" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M1.1665 7.0013H12.8332M12.8332 7.0013L6.99984 1.16797M12.8332 7.0013L6.99984 12.8346" stroke="#344054" stroke-width="1.67" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
